all(rownames(coldata_GSE151347) == colnames(cts_GSE151347))
dds_GSE151347 <- DESeqDataSetFromMatrix(countData = cts_GSE151347,
colData = coldata_GSE151347,
design = ~ tissue)
keep <- rowSums(counts(dds_GSE151347)) >= 10
dds_GSE151347 <- dds_GSE151347[keep,]
dds_GSE151347$tissue <- relevel(dds_GSE151347$tissue, ref = "Normal")
dds_GSE151347 <- estimateSizeFactors(dds_GSE151347)
normalized_counts_GSE151347 <- counts(dds_GSE151347, normalized=TRUE)
write.table(normalized_counts_GSE151347, file="Matrices_HB/GSE151347_normalized_counts.txt", sep="\t", quote=F, col.names=NA)
dds_GSE151347 <- DESeq(dds_GSE151347, parallel=TRUE)
res_GSE151347 <- results(dds_GSE151347, parallel=TRUE)
resSig_GSE151347 <- subset(res_GSE151347, padj < 0.05)
resSig_GSE151347 <- subset(resSig_GSE151347, abs(log2FoldChange) > 1)
nrow(resSig_GSE151347)
resSig_GSE151347 <- as.data.frame(resSig_GSE151347)
resSig_GSE151347 <- resSig_GSE151347[ order( -resSig_GSE151347$log2FoldChange ), ]
cols<-!(colnames(resSig_GSE151347) %in% c("baseMean","lfcSE","stat","pvalue","padj"))
resSig_GSE151347_subset <-subset(resSig_GSE151347,,cols)
write.table(resSig_GSE151347_subset, file="Matrices_HB/GSE151347_ranks.txt", sep="\t", quote=F, col.names=TRUE)
setwd("~/Documents/TFM/GitHub/HB_PublicData/1-Obtaining-DEGs-for-HB")
setwd("~/Documents/TFM/GitHub/HB_PublicData/1-Obtaining-DEGs-for-HB")
library(RobustRankAggreg)
GSE151347 <- read.csv("Matrices_HB/Ranks_HB/GSE133039_ranks.txt", sep="\t"row.names=1)
GSE151347 <- read.csv("Matrices_HB/Ranks_HB/GSE133039_ranks.txt", sep="\t", row.names=1)
View(GSE151347)
GSE104766 <- read.csv("Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t", row.names=1)
GSE133039 <- read.csv("Matrices_HB/Ranks_HB/GSE133039_ranks.txt", sep="\t", row.names=1)
GSE151347 <- read.csv("Matrices_HB/Ranks_HB/GSE151347_ranks.txt", sep="\t", row.names=1)
GSE133039 <- read.csv("Matrices_HB/Ranks_HB/GSE133039_ranks.txt", sep="\t", row.names=1)
setwd("~/Documents/TFM/GitHub/HB_PublicData/1-Obtaining-DEGs-for-HB")
library(RobustRankAggreg)
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t", row.names=1)
GSE104766 <- read.csv("Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t", row.names=1)
GSE133039 <- read.csv("Matrices_HB/Ranks_HB/GSE133039_ranks.txt", sep="\t", row.names=1)
GSE151347 <- read.csv("Matrices_HB/Ranks_HB/GSE151347_ranks.txt", sep="\t", row.names=1)
setwd("~/Documents/TFM/GitHub/HB_PublicData/1-Obtaining-DEGs-for-HB")
library(RobustRankAggreg)
library('biomaRt')
mart <- useDataset("hsapiens_gene_ensembl", useMart("ensembl"))
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
genes <- ES_joint$genes
View(GSE89775)
setwd("~/Documents/TFM/GitHub/HB_PublicData/1-Obtaining-DEGs-for-HB")
library(RobustRankAggreg)
library('biomaRt')
mart <- useDataset("hsapiens_gene_ensembl", useMart("ensembl"))
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
#genes <- GSE89775$genes
#G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes,mart= mart)
View(GSE89775)
setwd("~/Documents/TFM/GitHub/HB_PublicData/1-Obtaining-DEGs-for-HB")
library(RobustRankAggreg)
library('biomaRt')
mart <- useDataset("hsapiens_gene_ensembl", useMart("ensembl"))
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
#genes <- GSE89775$genes
#G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes,mart= mart)
setwd("~/Documents/TFM/GitHub/HB_PublicData/1-Obtaining-DEGs-for-HB")
library(RobustRankAggreg)
library('biomaRt')
mart <- useDataset("hsapiens_gene_ensembl", useMart("ensembl"))
View(GSE89775)
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
#genes <- GSE89775$genes
#G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes,mart= mart)
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
GSE104766 <- read.csv("Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t", row.names=1)
GSE133039 <- read.csv("Matrices_HB/Ranks_HB/GSE133039_ranks.txt", sep="\t", row.names=1)
GSE151347 <- read.csv("Matrices_HB/Ranks_HB/GSE151347_ranks.txt", sep="\t", row.names=1)
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
GSE104766 <- read.csv("Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t")
GSE133039 <- read.csv("Matrices_HB/Ranks_HB/GSE133039_ranks.txt", sep="\t")
GSE151347 <- read.csv("Matrices_HB/Ranks_HB/GSE151347_ranks.txt", sep="\t"
ES_joint <-merge(x = GSE89775, y = GSE104766, by= 'genes' , all = TRUE)
#ES_joint <-merge(x = ES_joint, y = GSE133039, by= 'genes' , all = TRUE)
#ES_joint <-merge(x = ES_joint, y = GSE151347, by= 'genes' , all = TRUE)
ES_joint <-merge(x = GSE89775, y = GSE104766, by= 'genes' , all = TRUE)
#ES_joint <-merge(x = ES_joint, y = GSE133039, by= 'genes' , all = TRUE)
#ES_joint <-merge(x = ES_joint, y = GSE151347, by= 'genes' , all = TRUE)
View(ES_joint)
ES_joint <-merge(x = GSE89775, y = GSE104766, by= 'genes' , all = TRUE)
ES_joint <-merge(x = ES_joint, y = GSE133039, by= 'genes' , all = TRUE)
#ES_joint <-merge(x = ES_joint, y = GSE151347, by= 'genes' , all = TRUE)
ES_joint <-merge(x = GSE89775, y = GSE104766, by= 'genes' , all = TRUE)
ES_joint <-merge(x = ES_joint, y = GSE133039, by= 'genes' , all = TRUE)
ES_joint <-merge(x = ES_joint, y = GSE151347, by= 'genes' , all = TRUE)
View(GSE151347)
GSE151347 <- read.csv("Matrices_HB/Ranks_HB/GSE151347_ranks.txt", sep="\t")
ES_joint <-merge(x = GSE89775, y = GSE104766, by= 'genes' , all = TRUE)
ES_joint <-merge(x = ES_joint, y = GSE133039, by= 'genes' , all = TRUE)
ES_joint <-merge(x = ES_joint, y = GSE151347, by= 'genes' , all = TRUE)
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
GSE104766 <- read.csv("Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t")
GSE133039 <- read.csv("Matrices_HB/Ranks_HB/GSE133039_ranks.txt", sep="\t")
GSE151347 <- read.csv("Matrices_HB/Ranks_HB/GSE151347_ranks.txt", sep="\t")
ES_joint <-merge(x = GSE89775, y = GSE104766, by= 'genes' , all = TRUE)
ES_joint <-merge(x = ES_joint, y = GSE133039, by= 'genes' , all = TRUE)
ES_joint <-merge(x = ES_joint, y = GSE151347, by= 'genes' , all = TRUE)
View(ES_joint)
dds_GSE104766 <- DESeq(dds_GSE104766, parallel=TRUE)
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
)
library(tidyverse)
library(readr)
library(DESeq2)
library(apeglm)
library(RobustRankAggreg)
library(BiocParallel)
register(MulticoreParam(2))
setwd("~/Documents/TFM/GitHub/HB_PublicData/1-Obtaining-DEGs-for-HB")
# Import Data
cts_GSE104766_path <- "Matrices_HB/Originals_HB/GSE104766_GeneLevel_Raw_data.csv"
cts_GSE104766 <- read.csv(cts_GSE104766_path, row.names=1)
cts_GSE104766[,]<- lapply(lapply(cts_GSE104766[,-1],round),as.integer)
# Import Metadata
Meta_GSE104766_path <- 'Metadata_HB/GSE104766_filtered_metadata.csv'
coldata_GSE104766 <- read.csv(Meta_GSE104766_path, row.names=1)
coldata_GSE104766$tissue[coldata_GSE104766$tissue == "Normal liver"] <- "Normal"
coldata_GSE104766$tissue <- factor(coldata_GSE104766$tissue)
# Convert data to matrix
cts_GSE104766 <- as.matrix(cts_GSE104766)
all(rownames(coldata_GSE104766) %in% colnames(cts_GSE104766))
all(rownames(coldata_GSE104766) == colnames(cts_GSE104766))
#cts_GSE133039 <- cts_GSE133039[, rownames(coldata_GSE133039)]
#all(rownames(coldata_GSE133039) == colnames(cts_GSE133039))
dds_GSE104766 <- DESeqDataSetFromMatrix(countData = cts_GSE104766,
colData = coldata_GSE104766,
design = ~ tissue)
keep <- rowSums(counts(dds_GSE104766)) >= 10
dds_GSE104766 <- dds_GSE104766[keep,]
dds_GSE104766$tissue <- relevel(dds_GSE104766$tissue, ref = "Normal")
dds_GSE104766 <- estimateSizeFactors(dds_GSE104766)
#normalized_counts_GSE104766 <- counts(dds_GSE104766, normalized=TRUE)
#write.table(normalized_counts_GSE104766, file="Matrices_HB/GSE104766_normalized_counts.txt", sep="\t", quote=F, col.names=NA)
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
)
library(tidyverse)
library(readr)
library(DESeq2)
library(apeglm)
library(RobustRankAggreg)
library(BiocParallel)
register(MulticoreParam(2))
setwd("~/Documents/TFM/GitHub/HB_PublicData/1-Obtaining-DEGs-for-HB")
# Import Data
cts_GSE104766_path <- "Matrices_HB/Originals_HB/GSE104766_GeneLevel_Raw_data.csv"
cts_GSE104766 <- read.csv(cts_GSE104766_path, row.names=1)
cts_GSE104766[,]<- lapply(lapply(cts_GSE104766[,-1],round),as.integer)
# Import Metadata
Meta_GSE104766_path <- 'Metadata_HB/GSE104766_filtered_metadata.csv'
coldata_GSE104766 <- read.csv(Meta_GSE104766_path, row.names=1)
coldata_GSE104766$tissue[coldata_GSE104766$tissue == "Normal liver"] <- "Normal"
coldata_GSE104766$tissue <- factor(coldata_GSE104766$tissue)
# Convert data to matrix
cts_GSE104766 <- as.matrix(cts_GSE104766)
all(rownames(coldata_GSE104766) %in% colnames(cts_GSE104766))
all(rownames(coldata_GSE104766) == colnames(cts_GSE104766))
#cts_GSE133039 <- cts_GSE133039[, rownames(coldata_GSE133039)]
#all(rownames(coldata_GSE133039) == colnames(cts_GSE133039))
dds_GSE104766 <- DESeqDataSetFromMatrix(countData = cts_GSE104766,
colData = coldata_GSE104766,
design = ~ tissue)
keep <- rowSums(counts(dds_GSE104766)) >= 10
dds_GSE104766 <- dds_GSE104766[keep,]
dds_GSE104766$tissue <- relevel(dds_GSE104766$tissue, ref = "Normal")
dds_GSE104766 <- estimateSizeFactors(dds_GSE104766)
#normalized_counts_GSE104766 <- counts(dds_GSE104766, normalized=TRUE)
#write.table(normalized_counts_GSE104766, file="Matrices_HB/GSE104766_normalized_counts.txt", sep="\t", quote=F, col.names=NA)
dds_GSE104766 <- DESeq(dds_GSE104766, parallel=TRUE)
res_GSE104766 <- results(dds_GSE104766, parallel=TRUE)
resSig_GSE104766 <- subset(res_GSE104766, padj < 0.05)
#resSig_GSE104766[, !c("baseMean","lfcSE","stat","pvalue")]
resSig_GSE104766 <- resSig_GSE104766[ order( -resSig_GSE104766$log2FoldChange ), ]
cols<-!(colnames(resSig_GSE104766) %in% c("baseMean","lfcSE","stat","pvalue","padj"))
resSig_GSE104766_subset <-subset(resSig_GSE104766,,cols)
# Upregulated genes
upreg_GSE104766 <- subset(resSig_GSE104766, log2FoldChange > 1)
upreg_GSE104766 <- as.data.frame(resSig_GSE104766)
#write.table(resSig_GSE104766_subset, file="Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t", quote=F, col.names=TRUE)
#resSig_GSE104766[, !c("baseMean","lfcSE","stat","pvalue")]
cols<-!(colnames(resSig_GSE104766) %in% c("baseMean","lfcSE","stat","pvalue","padj"))
resSig_GSE104766_subset <-subset(resSig_GSE104766,,cols)
resSig_GSE104766 <- subset(res_GSE104766, padj < 0.05)
cols<-!(colnames(resSig_GSE104766) %in% c("baseMean","lfcSE","stat","pvalue","padj"))
resSig_GSE104766_subset <-subset(resSig_GSE104766,,cols)
# Upregulated genes
upreg_GSE104766 <- subset(resSig_GSE104766, log2FoldChange > 1)
upreg_GSE104766 <- upreg_GSE104766[ order( -upreg_GSE104766$log2FoldChange ), ]
upreg_GSE104766 <- as.data.frame(upreg_GSE104766)
#write.table(resSig_GSE104766_subset, file="Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t", quote=F, col.names=TRUE)
# Upregulated genes
upreg_GSE104766 <- subset(resSig_GSE104766_subset, log2FoldChange > 1)
upreg_GSE104766 <- upreg_GSE104766[ order( -upreg_GSE104766$log2FoldChange ), ]
upreg_GSE104766 <- as.data.frame(upreg_GSE104766)
#write.table(resSig_GSE104766_subset, file="Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t", quote=F, col.names=TRUE)
View(upreg_GSE104766)
resSig_GSE104766 <- subset(res_GSE104766, padj < 0.05)
cols<-!(colnames(resSig_GSE104766) %in% c("baseMean","lfcSE","stat","pvalue","padj"))
resSig_GSE104766_subset <-subset(resSig_GSE104766,,cols)
View(resSig_GSE104766_subset)
# Upregulated genes
upreg_GSE104766 <- subset(resSig_GSE104766_subset, log2FoldChange > 1)
upreg_GSE104766 <- upreg_GSE104766[ order( upreg_GSE104766$log2FoldChange ), ]
#upreg_GSE104766 <- as.data.frame(upreg_GSE104766)
#write.table(resSig_GSE104766_subset, file="Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t", quote=F, col.names=TRUE)
# Upregulated genes
upreg_GSE104766 <- as.data.frame(upreg_GSE104766)
upreg_GSE104766 <- subset(resSig_GSE104766_subset, log2FoldChange > 1)
upreg_GSE104766 <- upreg_GSE104766[ order( upreg_GSE104766$log2FoldChange ), ]
#write.table(resSig_GSE104766_subset, file="Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t", quote=F, col.names=TRUE)
resSig_GSE104766 <- subset(res_GSE104766, padj < 0.05)
cols<-!(colnames(resSig_GSE104766) %in% c("baseMean","lfcSE","stat","pvalue","padj"))
resSig_GSE104766_subset <-subset(resSig_GSE104766,,cols)
resSig_GSE104766 <- as.data.frame(resSig_GSE104766)
View(resSig_GSE104766)
resSig_GSE104766 <- subset(res_GSE104766, padj < 0.05)
cols<-!(colnames(resSig_GSE104766) %in% c("baseMean","lfcSE","stat","pvalue","padj"))
resSig_GSE10476_subset <-subset(resSig_GSE104766,,cols)
resSig_GSE104766 <- as.data.frame(resSig_GSE104766)
# Upregulated genes
upreg_GSE104766 <- subset(resSig_GSE104766, log2FoldChange > 1)
upreg_GSE104766 <- upreg_GSE104766[ order( upreg_GSE104766$log2FoldChange ), ]
#write.table(resSig_GSE104766_subset, file="Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t", quote=F, col.names=TRUE)
resSig_GSE104766 <- subset(res_GSE104766, padj < 0.05)
cols<-!(colnames(resSig_GSE104766) %in% c("baseMean","lfcSE","stat","pvalue","padj"))
resSig_GSE10476 <-subset(resSig_GSE104766,,cols)
resSig_GSE104766 <- as.data.frame(resSig_GSE104766)
# Upregulated genes
upreg_GSE104766 <- subset(resSig_GSE104766, log2FoldChange > 1)
upreg_GSE104766 <- upreg_GSE104766[ order( upreg_GSE104766$log2FoldChange ), ]
#write.table(resSig_GSE104766_subset, file="Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t", quote=F, col.names=TRUE)
# Upregulated genes
upreg_GSE104766 <- subset(resSig_GSE104766, log2FoldChange > 1)
upreg_GSE104766 <- upreg_GSE104766[ order( upreg_GSE104766$log2FoldChange ), ]
#write.table(resSig_GSE104766_subset, file="Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t", quote=F, col.names=TRUE)
resSig_GSE104766 <- subset(res_GSE104766, padj < 0.05)
cols<-!(colnames(resSig_GSE104766) %in% c("baseMean","lfcSE","stat","pvalue","padj"))
resSig_GSE10476_subset <-subset(resSig_GSE104766,,cols)
resSig_GSE104766_subset <- as.data.frame(resSig_GSE104766)
resSig_GSE104766 <- subset(res_GSE104766, padj < 0.05)
cols<-!(colnames(resSig_GSE104766) %in% c("baseMean","lfcSE","stat","pvalue","padj"))
resSig_GSE10476_subset <-subset(resSig_GSE104766,,cols)
resSig_GSE104766_subset <- as.data.frame(resSig_GSE104766)
# Upregulated genes
upreg_GSE104766 <- subset(resSig_GSE104766_subset, log2FoldChange > 1)
upreg_GSE104766 <- upreg_GSE104766[ order( upreg_GSE104766$log2FoldChange ), ]
#write.table(resSig_GSE104766_subset, file="Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t", quote=F, col.names=TRUE)
resSig_GSE104766 <- subset(res_GSE104766, padj < 0.05)
cols<-!(colnames(resSig_GSE104766) %in% c("baseMean","lfcSE","stat","pvalue","padj"))
resSig_GSE104766_subset <-subset(resSig_GSE104766,,cols)
resSig_GSE104766_subset <- as.data.frame(resSig_GSE104766)
# Upregulated genes
upreg_GSE104766 <- subset(resSig_GSE104766_subset, log2FoldChange > 1)
upreg_GSE104766 <- upreg_GSE104766[ order( upreg_GSE104766$log2FoldChange ), ]
#write.table(resSig_GSE104766_subset, file="Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t", quote=F, col.names=TRUE)
resSig_GSE104766 <- subset(res_GSE104766, padj < 0.05)
cols<-!(colnames(resSig_GSE104766) %in% c("baseMean","lfcSE","stat","pvalue","padj"))
resSig_GSE104766_subset <-subset(resSig_GSE104766,,cols)
resSig_GSE104766_subset <- as.data.frame(resSig_GSE104766_subset)
# Upregulated genes
upreg_GSE104766 <- subset(resSig_GSE104766_subset, log2FoldChange > 1)
upreg_GSE104766 <- upreg_GSE104766[ order( upreg_GSE104766$log2FoldChange ), ]
#write.table(resSig_GSE104766_subset, file="Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t", quote=F, col.names=TRUE)
# Upregulated genes
upreg_GSE104766 <- subset(resSig_GSE104766_subset, log2FoldChange > 1)
upreg_GSE104766 <- upreg_GSE104766[ order( upreg_GSE104766$log2FoldChange ), ]
write.table(resSig_GSE104766_subset, file="Matrices_HB/Ranks_HB/GSE104766_upregulated.txt", sep="\t", quote=F, col.names=TRUE)
# Upregulated genes
upreg_GSE104766 <- subset(resSig_GSE104766_subset, log2FoldChange > 1)
upreg_GSE104766 <- upreg_GSE104766[ order( upreg_GSE104766$log2FoldChange ), ]
write.table(upreg_GSE104766, file="Matrices_HB/Ranks_HB/GSE104766_upregulated.txt", sep="\t", quote=F, col.names=TRUE)
# Upregulated genes
upreg_GSE104766 <- subset(resSig_GSE104766_subset, log2FoldChange > 1)
upreg_GSE104766 <- as.data.frame(upreg_GSE104766)
upreg_GSE104766 <- upreg_GSE104766[ order( upreg_GSE104766$log2FoldChange ), ]
write.table(upreg_GSE104766, file="Matrices_HB/Ranks_HB/GSE104766_upregulated.txt", sep="\t", quote=F, col.names=TRUE)
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
GSE89775_upregulated <- subset(GSE89775, GSE89775 > 1)
View(GSE89775_upregulated)
GSE89775_upregulated <- subset(GSE89775, GSE89775 > 1)
GSE104766_upregulated <- subset(GSE104766, GSE89775 > 1)
setwd("~/Documents/TFM/GitHub/HB_PublicData/1-Obtaining-DEGs-for-HB")
library(RobustRankAggreg)
library('biomaRt')
mart <- useDataset("hsapiens_gene_ensembl", useMart("ensembl"))
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
GSE104766 <- read.csv("Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t")
GSE133039 <- read.csv("Matrices_HB/Ranks_HB/GSE133039_ranks.txt", sep="\t")
GSE151347 <- read.csv("Matrices_HB/Ranks_HB/GSE151347_ranks.txt", sep="\t")
GSE89775_upregulated <- subset(GSE89775, GSE89775 > 1)
GSE104766_upregulated <- subset(GSE104766, GSE89775 > 1)
GSE133039_upregulated <- subset(GSE133039, GSE89775 > 1)
GSE151347_upregulated <- subset(GSE151347, GSE89775 > 1)
ES_upregulated <-merge(x = GSE89775_upregulated, y = GSE104766_upregulated, by= 'genes' , all = TRUE)
ES_upregulated <-merge(x = ES_joint, y = GSE133039_upregulated, by= 'genes' , all = TRUE)
upregulated <-merge(x = GSE89775_upregulated, y = GSE104766_upregulated, by= 'genes' , all = TRUE)
upregulated <-merge(x = upregulated, y = GSE133039_upregulated, by= 'genes' , all = TRUE)
upregulated <-merge(x = upregulated, y = GSE151347_upregulated, by= 'genes' , all = TRUE)
View(upregulated)
genes <- upregulated[['genes']]
genes <- upregulated[['genes']]
GSE89775 <- upregulated[['GSE89775']]
GSE104766 <- upregulated[['GSE104766']]
GSE133039 <- upregulated[['GSE133039']]
GSE151347 <- upregulated[['GSE151347']]
genes <- upregulated[['genes']]
GSE89775 <- upregulated[['GSE89775']]
GSE104766 <- upregulated[['GSE104766']]
GSE133039 <- upregulated[['GSE133039']]
GSE151347 <- upregulated[['GSE151347']]
glist = (list(GSE89775,GSE104766,GSE133039,GSE151347 ))
View(glist)
glist = (list(upregulated[['genes']],upregulated[['GSE89775']],upregulated[['GSE104766']],upregulated[['GSE133039']],upregulated[['GSE151347']]))
aggregateRanks(glist,
rmat = rankMatrix(glist, N, full = full), N = NA,
method = "RRA", full = FALSE, exact = F,
topCutoff = NA)
aggregateRanks(glist,
rmat = rankMatrix(glist, full = full), N = NA,
method = "RRA", full = FALSE, exact = F,
topCutoff = NA)
aggregateRanks(glist,
rmat = rankMatrix(glist), N = NA,
method = "RRA", full = FALSE, exact = F,
topCutoff = NA)
aggregateRanks(glist, rmat = rankMatrix(glist))
aggregateRanks(glist, rmat = rankMatrix(glist), n_valid_srcs=5, min_src=1, method='geom')
aggregateRanks(glist, rmat = rankMatrix(glist), n_valid_srcs=4, min_src=1, method='geom')
aggregateRanks(glist, rmat = rankMatrix(glist), method='geom')
aggregateRanks(glist, rmat = rankMatrix(glist), method='geom')
aggregateRanks(glist, rmat = rankMatrix(glist), method='geom.mean')
aggregateRanks(glist, rmat = rankMatrix(glist), method='geom.mean')
aggregateRanks(glist = glist, N = length(upregulated))
r = rankMatrix(glist)
install.packages("miRNAtap")
setwd("~/Documents/TFM/GitHub/HB_PublicData/1-Obtaining-DEGs-for-HB")
library(miRNAtap)
BiocManager::install("miRNAtap")
library(miRNAtap)
aggregateRanks(upregulated, n_valid_srcs=4, min_src=2, method='geom')
library(miRNAtap)
miRNAtap::aggregateRanks(upregulated, n_valid_srcs=4, min_src=2, method='geom')
library(miRNAtap)
miRNAtap::aggregateRanks(upregulated, n_valid_srcs=4, min_src=1, method='geom')
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
genes_GSE89775 <- GSE89775 $genes_GSE89775
G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes,mart= mart)
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
genes_GSE89775 <- GSE89775 $genes_GSE89775
G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes,mart= mart)
View(G_list)
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
genes_GSE89775 <- GSE89775 $genes_GSE89775
G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes,mart= mart)
merge(GSE89775,G_list,by.x="gene",by.y="ensembl_peptide_id")
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
genes_GSE89775 <- GSE89775 $genes_GSE89775
G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes,mart= mart)
merge(GSE89775,G_list,by.x="gene",by.y="ensembl_gene_id")
View(GSE89775)
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
genes_GSE89775 <- GSE89775 $genes_GSE89775
G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes,mart= mart)
merge(GSE89775,G_list,by.x="genes",by.y="ensembl_gene_id")
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
genes_GSE89775 <- GSE89775 $genes_GSE89775
G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes,mart= mart)
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
genes_GSE89775 <- GSE89775 $genes_GSE89775
G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes,mart= mart)
setwd("~/Documents/TFM/GitHub/HB_PublicData/1-Obtaining-DEGs-for-HB")
library(miRNAtap)
library('biomaRt')
mart <- useDataset("hsapiens_gene_ensembl", useMart("ensembl"))
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
genes_GSE89775 <- GSE89775 $genes_GSE89775
G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes,mart= mart)
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
genes_GSE89775 <- GSE89775 $genes_GSE89775
G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes,mart= mart)
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
genes_GSE89775 <- GSE89775$genes_GSE89775
G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE89775 ,mart= mart)
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
genes_GSE89775 <- GSE89775$genes_GSE89775
G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE89775 ,mart= mart)
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
genes_GSE89775 <- GSE89775$genes
G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE89775 ,mart= mart)
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
genes_GSE89775 <- GSE89775$genes
G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE89775 ,mart= mart)
View(GSE89775)
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
genes_GSE89775 <- GSE89775$genes
G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE89775 ,mart= mart)
merge(GSE89775,G_list,by.x="genes",by.y="ensembl_gene_id")
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
genes_GSE89775 <- GSE89775$genes
G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE89775 ,mart= mart)
GSE89775_sym <- merge(GSE89775,G_list,by.x="genes",by.y="ensembl_gene_id")
GSE89775_sym  <- subset(GSE89775_sym , select = -genes)
View(GSE89775_sym)
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
genes_GSE89775 <- GSE89775$genes
G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE89775 ,mart= mart)
GSE89775_sym <- merge(GSE89775,G_list,by.x="genes",by.y="ensembl_gene_id")
GSE89775_sym  <- subset(GSE89775_sym , select = -genes)
GSE89775_sym <- aggregate(d[, 1], list(GSE89775_sym$hgnc_symbol), mean)
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
genes_GSE89775 <- GSE89775$genes
G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE89775 ,mart= mart)
GSE89775_sym <- merge(GSE89775,G_list,by.x="genes",by.y="ensembl_gene_id")
GSE89775_sym  <- subset(GSE89775_sym , select = -genes)
GSE89775_sym <- aggregate(GSE89775_sym[, 1], list(GSE89775_sym$hgnc_symbol), mean)
GSE89775 <- read.csv("Matrices_HB/Ranks_HB/GSE89775_ranks.txt", sep="\t")
genes_GSE89775 <- GSE89775$genes
G_list <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE89775 ,mart= mart)
GSE89775_sym <- merge(GSE89775,G_list,by.x="genes",by.y="ensembl_gene_id")
GSE89775_sym  <- subset(GSE89775_sym , select = -genes)
GSE89775_sym <- aggregate(GSE89775_sym[, 1], list(GSE89775_sym$hgnc_symbol), mean)
GSE89775_sym[!(is.na(GSE89775_sym$hgnc_symbol) | GSE89775_sym$hgnc_symbol==""), ]
GSE104766 <- read.csv("Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t")
genes_GSE104766 <- GSE104766$genes
genes_GSE104766 <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE104766 ,mart= mart)
GSE104766 <- read.csv("Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t")
genes_GSE104766 <- GSE104766$genes
genes_GSE104766 <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE104766 ,mart= mart)
GSE104766 <- merge(GSE104766,G_list,by.x="genes",by.y="ensembl_gene_id")
GSE104766  <- subset(GSE104766, select = -genes)
GSE104766 <- aggregate(GSE104766[, 1], list(GSE104766$hgnc_symbol), mean)
GSE104766[!(is.na(GSE104766$hgnc_symbol) | GSE104766$hgnc_symbol==""), ]
GSE104766 <- read.csv("Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t")
genes_GSE104766 <- GSE104766$genes
genes_GSE104766 <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE104766 ,mart= mart)
GSE104766 <- merge(GSE104766,G_list,by.x="genes",by.y="ensembl_gene_id")
#GSE104766  <- subset(GSE104766, select = -genes)
#GSE104766 <- aggregate(GSE104766[, 1], list(GSE104766$hgnc_symbol), mean)
#GSE104766[!(is.na(GSE104766$hgnc_symbol) | GSE104766$hgnc_symbol==""), ]
View(GSE104766)
GSE104766 <- read.csv("Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t")
genes_GSE104766 <- GSE104766$genes
genes_GSE104766 <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE104766 ,mart= mart)
GSE104766 <- merge(GSE104766,G_list,by.x="genes",by.y="ensembl_gene_id")
GSE104766  <- subset(GSE104766, select = -genes)
#GSE104766 <- aggregate(GSE104766[, 1], list(GSE104766$hgnc_symbol), mean)
#GSE104766[!(is.na(GSE104766$hgnc_symbol) | GSE104766$hgnc_symbol==""), ]
GSE104766 <- read.csv("Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t")
genes_GSE104766 <- GSE104766$genes
genes_GSE104766 <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE104766 ,mart= mart)
GSE104766 <- merge(GSE104766,G_list,by.x="genes",by.y="ensembl_gene_id")
GSE104766  <- subset(GSE104766, select = -genes)
GSE104766 <- aggregate(GSE104766[, 1], list(GSE104766$hgnc_symbol), mean)
#GSE104766[!(is.na(GSE104766$hgnc_symbol) | GSE104766$hgnc_symbol==""), ]
GSE104766 <- read.csv("Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t")
genes_GSE104766 <- GSE104766$genes
genes_GSE104766 <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE104766 ,mart= mart)
GSE104766 <- merge(GSE104766,G_list,by.x="genes",by.y="ensembl_gene_id")
GSE104766  <- subset(GSE104766, select = -genes)
GSE104766[!(is.na(GSE104766$hgnc_symbol) | GSE104766$hgnc_symbol==""), ]
GSE104766 <- aggregate(GSE104766[, 1], list(GSE104766$hgnc_symbol), mean)
GSE104766 <- read.csv("Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t")
genes_GSE104766 <- GSE104766$genes
genes_GSE104766 <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE104766 ,mart= mart)
GSE104766 <- merge(GSE104766,G_list,by.x="genes",by.y="ensembl_gene_id")
GSE104766  <- subset(GSE104766, select = -genes)
GSE104766[!(is.na(GSE104766$hgnc_symbol) | GSE104766$hgnc_symbol==""), ]
GSE104766 <- aggregate(GSE104766[, 1], list(GSE104766$hgnc_symbol), mean)
GSE104766 <- GSE104766[ order( GSE104766$GSE104766 ), ]
GSE104766 <- read.csv("Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t")
genes_GSE104766 <- GSE104766$genes
genes_GSE104766 <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE104766 ,mart= mart)
GSE104766 <- merge(GSE104766,genes_GSE104766,by.x="genes",by.y="ensembl_gene_id")
GSE104766  <- subset(GSE104766, select = -genes)
GSE104766[!(is.na(GSE104766$hgnc_symbol) | GSE104766$hgnc_symbol==""), ]
GSE104766 <- aggregate(GSE104766[, 1], list(GSE104766$hgnc_symbol), mean)
GSE104766 <- GSE104766[ order( GSE104766$GSE104766 ), ]
View(GSE104766)
GSE104766 <- read.csv("Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t")
genes_GSE104766 <- GSE104766$genes
genes_GSE104766 <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE104766 ,mart= mart)
GSE104766 <- merge(GSE104766,genes_GSE104766,by.x="genes",by.y="ensembl_gene_id")
GSE104766  <- subset(GSE104766, select = -genes)
GSE104766 <- GSE104766[!(is.na(GSE104766$hgnc_symbol) | GSE104766$hgnc_symbol==""), ]
GSE104766 <- aggregate(GSE104766[, 1], list(GSE104766$hgnc_symbol), mean)
GSE104766 <- GSE104766[ order( GSE104766$GSE104766 ), ]
GSE104766 <- read.csv("Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t")
genes_GSE104766 <- GSE104766$genes
genes_GSE104766 <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE104766 ,mart= mart)
GSE104766 <- merge(GSE104766,genes_GSE104766,by.x="genes",by.y="ensembl_gene_id")
GSE104766  <- subset(GSE104766, select = -genes)
GSE104766 <- GSE104766[!(is.na(GSE104766$hgnc_symbol) | GSE104766$hgnc_symbol==""), ]
GSE104766 <- aggregate(GSE104766[, 1], list(GSE104766$hgnc_symbol), mean)
GSE104766 <- GSE104766[ order( GSE104766$x ), ]
GSE104766 <- read.csv("Matrices_HB/Ranks_HB/GSE104766_ranks.txt", sep="\t")
genes_GSE104766 <- GSE104766$genes
genes_GSE104766 <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE104766 ,mart= mart)
GSE104766 <- merge(GSE104766,genes_GSE104766,by.x="genes",by.y="ensembl_gene_id")
GSE104766  <- subset(GSE104766, select = -genes)
GSE104766 <- GSE104766[!(is.na(GSE104766$hgnc_symbol) | GSE104766$hgnc_symbol==""), ]
GSE104766 <- aggregate(GSE104766[, 1], list(GSE104766$hgnc_symbol), mean)
GSE104766 <- GSE104766[ order( -GSE104766$x ), ]
GSE104766 <- read.csv("Matrices_HB/Ranks_HB/GSE104766_upregulated.txt", sep="\t")
genes_GSE104766 <- GSE104766$genes
genes_GSE104766 <- getBM(filters= "ensembl_gene_id", attributes= c("ensembl_gene_id","hgnc_symbol"),values=genes_GSE104766 ,mart= mart)
